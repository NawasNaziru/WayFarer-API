var cov_2qn8m28rek=function(){var path="C:\\Users\\owner\\Banka\\app_api\\controllers\\accounts.js";var hash="20ccd459b98cd28f79de74f0c72d70318c25ed89";var Function=function(){}.constructor;var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\owner\\Banka\\app_api\\controllers\\accounts.js",statementMap:{"0":{start:{line:3,column:25},end:{line:6,column:1}},"1":{start:{line:4,column:2},end:{line:4,column:21}},"2":{start:{line:5,column:2},end:{line:5,column:20}},"3":{start:{line:10,column:2},end:{line:10,column:172}},"4":{start:{line:13,column:14},end:{line:20,column:1}},"5":{start:{line:14,column:2},end:{line:18,column:3}},"6":{start:{line:14,column:15},end:{line:14,column:16}},"7":{start:{line:15,column:4},end:{line:17,column:5}},"8":{start:{line:16,column:6},end:{line:16,column:18}},"9":{start:{line:19,column:2},end:{line:19,column:15}},"10":{start:{line:22,column:0},end:{line:55,column:2}},"11":{start:{line:23,column:2},end:{line:54,column:3}},"12":{start:{line:24,column:4},end:{line:27,column:7}},"13":{start:{line:29,column:4},end:{line:34,column:5}},"14":{start:{line:30,column:6},end:{line:33,column:9}},"15":{start:{line:36,column:20},end:{line:36,column:22}},"16":{start:{line:38,column:4},end:{line:38,column:40}},"17":{start:{line:39,column:4},end:{line:39,column:21}},"18":{start:{line:40,column:4},end:{line:40,column:43}},"19":{start:{line:41,column:4},end:{line:41,column:41}},"20":{start:{line:42,column:4},end:{line:42,column:35}},"21":{start:{line:43,column:4},end:{line:43,column:40}},"22":{start:{line:44,column:4},end:{line:44,column:34}},"23":{start:{line:45,column:4},end:{line:45,column:36}},"24":{start:{line:46,column:4},end:{line:46,column:45}},"25":{start:{line:47,column:4},end:{line:47,column:30}},"26":{start:{line:48,column:4},end:{line:48,column:27}},"27":{start:{line:49,column:4},end:{line:49,column:46}},"28":{start:{line:51,column:4},end:{line:51,column:46}},"29":{start:{line:53,column:4},end:{line:53,column:63}},"30":{start:{line:57,column:0},end:{line:103,column:2}},"31":{start:{line:58,column:2},end:{line:64,column:3}},"32":{start:{line:59,column:4},end:{line:62,column:7}},"33":{start:{line:63,column:4},end:{line:63,column:11}},"34":{start:{line:66,column:2},end:{line:72,column:3}},"35":{start:{line:67,column:4},end:{line:70,column:7}},"36":{start:{line:71,column:4},end:{line:71,column:11}},"37":{start:{line:74,column:2},end:{line:80,column:3}},"38":{start:{line:75,column:4},end:{line:78,column:7}},"39":{start:{line:79,column:4},end:{line:79,column:11}},"40":{start:{line:82,column:2},end:{line:88,column:3}},"41":{start:{line:83,column:4},end:{line:86,column:7}},"42":{start:{line:87,column:4},end:{line:87,column:11}},"43":{start:{line:90,column:2},end:{line:96,column:3}},"44":{start:{line:91,column:4},end:{line:94,column:7}},"45":{start:{line:95,column:4},end:{line:95,column:11}},"46":{start:{line:99,column:2},end:{line:99,column:169}},"47":{start:{line:100,column:18},end:{line:100,column:52}},"48":{start:{line:102,column:2},end:{line:102,column:61}},"49":{start:{line:105,column:0},end:{line:149,column:2}},"50":{start:{line:106,column:2},end:{line:112,column:3}},"51":{start:{line:107,column:4},end:{line:110,column:7}},"52":{start:{line:111,column:4},end:{line:111,column:11}},"53":{start:{line:114,column:2},end:{line:148,column:3}},"54":{start:{line:115,column:4},end:{line:118,column:7}},"55":{start:{line:120,column:4},end:{line:126,column:5}},"56":{start:{line:121,column:6},end:{line:124,column:9}},"57":{start:{line:125,column:6},end:{line:125,column:13}},"58":{start:{line:128,column:25},end:{line:128,column:46}},"59":{start:{line:130,column:4},end:{line:136,column:5}},"60":{start:{line:131,column:6},end:{line:134,column:9}},"61":{start:{line:135,column:6},end:{line:135,column:13}},"62":{start:{line:138,column:4},end:{line:144,column:5}},"63":{start:{line:139,column:6},end:{line:142,column:9}},"64":{start:{line:143,column:6},end:{line:143,column:13}},"65":{start:{line:146,column:4},end:{line:146,column:46}},"66":{start:{line:147,column:4},end:{line:147,column:90}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:3,column:25},end:{line:3,column:26}},loc:{start:{line:3,column:57},end:{line:6,column:1}},line:3},"1":{name:"timeStamp",decl:{start:{line:9,column:9},end:{line:9,column:18}},loc:{start:{line:9,column:21},end:{line:11,column:1}},line:9},"2":{name:"(anonymous_2)",decl:{start:{line:13,column:14},end:{line:13,column:15}},loc:{start:{line:13,column:33},end:{line:20,column:1}},line:13},"3":{name:"(anonymous_3)",decl:{start:{line:22,column:24},end:{line:22,column:25}},loc:{start:{line:22,column:44},end:{line:55,column:1}},line:22},"4":{name:"(anonymous_4)",decl:{start:{line:57,column:37},end:{line:57,column:38}},loc:{start:{line:57,column:57},end:{line:103,column:1}},line:57},"5":{name:"(anonymous_5)",decl:{start:{line:105,column:24},end:{line:105,column:25}},loc:{start:{line:105,column:44},end:{line:149,column:1}},line:105}},branchMap:{"0":{loc:{start:{line:15,column:4},end:{line:17,column:5}},type:"if",locations:[{start:{line:15,column:4},end:{line:17,column:5}},{start:{line:15,column:4},end:{line:17,column:5}}],line:15},"1":{loc:{start:{line:23,column:2},end:{line:54,column:3}},type:"if",locations:[{start:{line:23,column:2},end:{line:54,column:3}},{start:{line:23,column:2},end:{line:54,column:3}}],line:23},"2":{loc:{start:{line:23,column:6},end:{line:23,column:91}},type:"binary-expr",locations:[{start:{line:23,column:6},end:{line:23,column:25}},{start:{line:23,column:29},end:{line:23,column:47}},{start:{line:23,column:51},end:{line:23,column:66}},{start:{line:23,column:70},end:{line:23,column:91}}],line:23},"3":{loc:{start:{line:29,column:4},end:{line:34,column:5}},type:"if",locations:[{start:{line:29,column:4},end:{line:34,column:5}},{start:{line:29,column:4},end:{line:34,column:5}}],line:29},"4":{loc:{start:{line:58,column:2},end:{line:64,column:3}},type:"if",locations:[{start:{line:58,column:2},end:{line:64,column:3}},{start:{line:58,column:2},end:{line:64,column:3}}],line:58},"5":{loc:{start:{line:66,column:2},end:{line:72,column:3}},type:"if",locations:[{start:{line:66,column:2},end:{line:72,column:3}},{start:{line:66,column:2},end:{line:72,column:3}}],line:66},"6":{loc:{start:{line:74,column:2},end:{line:80,column:3}},type:"if",locations:[{start:{line:74,column:2},end:{line:80,column:3}},{start:{line:74,column:2},end:{line:80,column:3}}],line:74},"7":{loc:{start:{line:82,column:2},end:{line:88,column:3}},type:"if",locations:[{start:{line:82,column:2},end:{line:88,column:3}},{start:{line:82,column:2},end:{line:88,column:3}}],line:82},"8":{loc:{start:{line:90,column:2},end:{line:96,column:3}},type:"if",locations:[{start:{line:90,column:2},end:{line:96,column:3}},{start:{line:90,column:2},end:{line:96,column:3}}],line:90},"9":{loc:{start:{line:90,column:8},end:{line:90,column:122}},type:"binary-expr",locations:[{start:{line:90,column:8},end:{line:90,column:63}},{start:{line:90,column:67},end:{line:90,column:122}}],line:90},"10":{loc:{start:{line:99,column:2},end:{line:99,column:168}},type:"cond-expr",locations:[{start:{line:99,column:60},end:{line:99,column:112}},{start:{line:99,column:115},end:{line:99,column:168}}],line:99},"11":{loc:{start:{line:106,column:2},end:{line:112,column:3}},type:"if",locations:[{start:{line:106,column:2},end:{line:112,column:3}},{start:{line:106,column:2},end:{line:112,column:3}}],line:106},"12":{loc:{start:{line:114,column:2},end:{line:148,column:3}},type:"if",locations:[{start:{line:114,column:2},end:{line:148,column:3}},{start:{line:114,column:2},end:{line:148,column:3}}],line:114},"13":{loc:{start:{line:120,column:4},end:{line:126,column:5}},type:"if",locations:[{start:{line:120,column:4},end:{line:126,column:5}},{start:{line:120,column:4},end:{line:126,column:5}}],line:120},"14":{loc:{start:{line:130,column:4},end:{line:136,column:5}},type:"if",locations:[{start:{line:130,column:4},end:{line:136,column:5}},{start:{line:130,column:4},end:{line:136,column:5}}],line:130},"15":{loc:{start:{line:138,column:4},end:{line:144,column:5}},type:"if",locations:[{start:{line:138,column:4},end:{line:144,column:5}},{start:{line:138,column:4},end:{line:144,column:5}}],line:138},"16":{loc:{start:{line:138,column:10},end:{line:138,column:106}},type:"binary-expr",locations:[{start:{line:138,column:10},end:{line:138,column:56}},{start:{line:138,column:60},end:{line:138,column:106}}],line:138}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0},b:{"0":[0,0],"1":[0,0],"2":[0,0,0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0]},_coverageSchema:"43e27e138ebf9cfc5966b082cf9a028302ed4184"};var coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();cov_2qn8m28rek.s[0]++;/* eslint-disable func-names */ /* eslint-disable no-undef */const sendJSONresponse=function(res,status,content){cov_2qn8m28rek.f[0]++;cov_2qn8m28rek.s[1]++;res.status(status);cov_2qn8m28rek.s[2]++;res.json(content);};// eslint-disable-next-line no-useless-concat
function timeStamp(){cov_2qn8m28rek.f[1]++;cov_2qn8m28rek.s[3]++;return`${new Date().getFullYear()}-${new Date().getMonth()+1}-${new Date().getDate()}  ${new Date().getHours()}:${new Date().getMinutes()}:${new Date().getSeconds()}`;}cov_2qn8m28rek.s[4]++;const hasId=function(arr,id){cov_2qn8m28rek.f[2]++;cov_2qn8m28rek.s[5]++;for(let i=(cov_2qn8m28rek.s[6]++,0);i<arr.length;i+=1){cov_2qn8m28rek.s[7]++;if(arr[i]===id){cov_2qn8m28rek.b[0][0]++;cov_2qn8m28rek.s[8]++;return true;}else{cov_2qn8m28rek.b[0][1]++;}}cov_2qn8m28rek.s[9]++;return false;};cov_2qn8m28rek.s[10]++;module.exports.create=function(req,res){cov_2qn8m28rek.f[3]++;cov_2qn8m28rek.s[11]++;if((cov_2qn8m28rek.b[2][0]++,!req.body.firstName)||(cov_2qn8m28rek.b[2][1]++,!req.body.lastName)||(cov_2qn8m28rek.b[2][2]++,!req.body.email)||(cov_2qn8m28rek.b[2][3]++,!req.body.accountType)){cov_2qn8m28rek.b[1][0]++;cov_2qn8m28rek.s[12]++;sendJSONresponse(res,400,{status:400,error:'First name, last name, email and accountType are required, please!'});}else{cov_2qn8m28rek.b[1][1]++;cov_2qn8m28rek.s[13]++;if(!Users[req.body.email]){cov_2qn8m28rek.b[3][0]++;cov_2qn8m28rek.s[14]++;sendJSONresponse(res,404,{status:404,error:'You have not signed up. Sign up first to create an account!'});}else{cov_2qn8m28rek.b[3][1]++;}const account=(cov_2qn8m28rek.s[15]++,{});cov_2qn8m28rek.s[16]++;account.accountNumber=nextAccount;cov_2qn8m28rek.s[17]++;nextAccount+=1;cov_2qn8m28rek.s[18]++;account.firstName=req.body.firstName;cov_2qn8m28rek.s[19]++;account.lastName=req.body.lastName;cov_2qn8m28rek.s[20]++;account.email=req.body.email;cov_2qn8m28rek.s[21]++;account.type=req.body.accountType;cov_2qn8m28rek.s[22]++;account.openingBalance=0.00;cov_2qn8m28rek.s[23]++;account.createdOn=timeStamp();cov_2qn8m28rek.s[24]++;account.owner=Users[req.body.email].id;cov_2qn8m28rek.s[25]++;account.status='active';cov_2qn8m28rek.s[26]++;account.balance=0.00;cov_2qn8m28rek.s[27]++;account.id=Object.keys(Accounts).length;cov_2qn8m28rek.s[28]++;Accounts[account.accountNumber]=account;cov_2qn8m28rek.s[29]++;sendJSONresponse(res,201,{status:201,data:account});}};cov_2qn8m28rek.s[30]++;module.exports.activate_deactivate=function(req,res){cov_2qn8m28rek.f[4]++;cov_2qn8m28rek.s[31]++;if(!req.params.accountNumber){cov_2qn8m28rek.b[4][0]++;cov_2qn8m28rek.s[32]++;sendJSONresponse(res,400,{status:400,error:'You have not specified the account number in the params!'});cov_2qn8m28rek.s[33]++;return;}else{cov_2qn8m28rek.b[4][1]++;}cov_2qn8m28rek.s[34]++;if(!req.body.email){cov_2qn8m28rek.b[5][0]++;cov_2qn8m28rek.s[35]++;sendJSONresponse(res,400,{status:400,error:'Enter your email!'});cov_2qn8m28rek.s[36]++;return;}else{cov_2qn8m28rek.b[5][1]++;}cov_2qn8m28rek.s[37]++;if(!Accounts[req.params.accountNumber]){cov_2qn8m28rek.b[6][0]++;cov_2qn8m28rek.s[38]++;sendJSONresponse(res,404,{status:404,error:"Account number doesn't exist in the first place or it was deleted!"});cov_2qn8m28rek.s[39]++;return;}else{cov_2qn8m28rek.b[6][1]++;}cov_2qn8m28rek.s[40]++;if(!Users[req.body.email]){cov_2qn8m28rek.b[7][0]++;cov_2qn8m28rek.s[41]++;sendJSONresponse(res,404,{status:404,error:'You have not signed up!'});cov_2qn8m28rek.s[42]++;return;}else{cov_2qn8m28rek.b[7][1]++;}cov_2qn8m28rek.s[43]++;if(!((cov_2qn8m28rek.b[9][0]++,hasId(staffIds,parseInt(Users[req.body.email].id,10)))||(cov_2qn8m28rek.b[9][1]++,hasId(adminIds,parseInt(Users[req.body.email].id,10))))){cov_2qn8m28rek.b[8][0]++;cov_2qn8m28rek.s[44]++;sendJSONresponse(res,404,{status:404,error:'Register as Staff or Admin first, using your privately assigned Id!'});cov_2qn8m28rek.s[45]++;return;}else{cov_2qn8m28rek.b[8][1]++;}// eslint-disable-next-line no-unused-expressions
cov_2qn8m28rek.s[46]++;Accounts[req.params.accountNumber].status==='dormant'?(cov_2qn8m28rek.b[10][0]++,Accounts[req.params.accountNumber].status='active'):(cov_2qn8m28rek.b[10][1]++,Accounts[req.params.accountNumber].status='dormant');const account=(cov_2qn8m28rek.s[47]++,Accounts[req.params.accountNumber]);cov_2qn8m28rek.s[48]++;sendJSONresponse(res,201,{status:201,data:account});};cov_2qn8m28rek.s[49]++;module.exports.delete=function(req,res){cov_2qn8m28rek.f[5]++;cov_2qn8m28rek.s[50]++;if(!req.params.accountNumber){cov_2qn8m28rek.b[11][0]++;cov_2qn8m28rek.s[51]++;sendJSONresponse(res,400,{status:400,error:'You have not specified the account number in the params!'});cov_2qn8m28rek.s[52]++;return;}else{cov_2qn8m28rek.b[11][1]++;}cov_2qn8m28rek.s[53]++;if(!req.body.email){cov_2qn8m28rek.b[12][0]++;cov_2qn8m28rek.s[54]++;sendJSONresponse(res,400,{status:400,error:'Enter your email!'});}else{cov_2qn8m28rek.b[12][1]++;cov_2qn8m28rek.s[55]++;if(!Accounts[req.params.accountNumber]){cov_2qn8m28rek.b[13][0]++;cov_2qn8m28rek.s[56]++;sendJSONresponse(res,404,{status:404,error:"Account number doesn't exist in the first place or it was deleted!"});cov_2qn8m28rek.s[57]++;return;}else{cov_2qn8m28rek.b[13][1]++;}const regUserEmail=(cov_2qn8m28rek.s[58]++,Users[req.body.email]);cov_2qn8m28rek.s[59]++;if(!regUserEmail){cov_2qn8m28rek.b[14][0]++;cov_2qn8m28rek.s[60]++;sendJSONresponse(res,404,{status:404,error:'You have not signed up to perform this action!'});cov_2qn8m28rek.s[61]++;return;}else{cov_2qn8m28rek.b[14][1]++;}cov_2qn8m28rek.s[62]++;if(!((cov_2qn8m28rek.b[16][0]++,hasId(staffIds,parseInt(regUserEmail.id,10)))||(cov_2qn8m28rek.b[16][1]++,hasId(adminIds,parseInt(regUserEmail.id,10))))){cov_2qn8m28rek.b[15][0]++;cov_2qn8m28rek.s[63]++;sendJSONresponse(res,404,{status:404,error:'Register as Staff or Admin first, using your privately assigned Id!'});cov_2qn8m28rek.s[64]++;return;}else{cov_2qn8m28rek.b[15][1]++;}cov_2qn8m28rek.s[65]++;delete Accounts[req.params.accountNumber];cov_2qn8m28rek.s[66]++;sendJSONresponse(res,200,{status:204,message:'Account deleted successfully!'});}};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFjY291bnRzLmpzIl0sIm5hbWVzIjpbInNlbmRKU09OcmVzcG9uc2UiLCJyZXMiLCJzdGF0dXMiLCJjb250ZW50IiwianNvbiIsInRpbWVTdGFtcCIsIkRhdGUiLCJnZXRGdWxsWWVhciIsImdldE1vbnRoIiwiZ2V0RGF0ZSIsImdldEhvdXJzIiwiZ2V0TWludXRlcyIsImdldFNlY29uZHMiLCJoYXNJZCIsImFyciIsImlkIiwiaSIsImxlbmd0aCIsIm1vZHVsZSIsImV4cG9ydHMiLCJjcmVhdGUiLCJyZXEiLCJib2R5IiwiZmlyc3ROYW1lIiwibGFzdE5hbWUiLCJlbWFpbCIsImFjY291bnRUeXBlIiwiZXJyb3IiLCJVc2VycyIsImFjY291bnQiLCJhY2NvdW50TnVtYmVyIiwibmV4dEFjY291bnQiLCJ0eXBlIiwib3BlbmluZ0JhbGFuY2UiLCJjcmVhdGVkT24iLCJvd25lciIsImJhbGFuY2UiLCJPYmplY3QiLCJrZXlzIiwiQWNjb3VudHMiLCJkYXRhIiwiYWN0aXZhdGVfZGVhY3RpdmF0ZSIsInBhcmFtcyIsInN0YWZmSWRzIiwicGFyc2VJbnQiLCJhZG1pbklkcyIsImRlbGV0ZSIsInJlZ1VzZXJFbWFpbCIsIm1lc3NhZ2UiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQSxNQUFNQSxtQkFBbUIsVUFBVUMsR0FBVixFQUFlQyxNQUFmLEVBQXVCQyxPQUF2QixFQUFnQztBQUN2REYsTUFBSUMsTUFBSixDQUFXQSxNQUFYO0FBQ0FELE1BQUlHLElBQUosQ0FBU0QsT0FBVDtBQUNELENBSEQ7O0FBS0E7QUFDQSxTQUFTRSxTQUFULEdBQXFCO0FBQ25CLFNBQVEsR0FBRyxJQUFJQyxJQUFKLEVBQUQsQ0FBYUMsV0FBYixFQUEyQixJQUFJLElBQUlELElBQUosRUFBRCxDQUFhRSxRQUFiLEtBQTBCLENBQUUsSUFBSSxJQUFJRixJQUFKLEVBQUQsQ0FBYUcsT0FBYixFQUF1QixLQUFLLElBQUlILElBQUosRUFBRCxDQUFhSSxRQUFiLEVBQXdCLElBQUks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SUE7QUFDRDs7QUFFRCxXQUFPWSxTQUFTbEIsSUFBSXFCLE1BQUosQ0FBV1osYUFBcEIsQ0FBUDtBQUNBOUIscUJBQWlCQyxHQUFqQixFQUFzQixHQUF0QixFQUEyQixFQUFFQyxRQUFRLEdBQVYsRUFBZThDLFNBQVMsK0JBQXhCLEVBQTNCO0FBQ0Q7QUFDRixDQTdDRCIsImZpbGUiOiJhY2NvdW50cy5qcyIsInNvdXJjZVJvb3QiOiJDOi9Vc2Vycy9vd25lci9CYW5rYS9hcHBfYXBpL2NvbnRyb2xsZXJzIiwic291cmNlc0NvbnRlbnQiOlsiLyogZXNsaW50LWRpc2FibGUgZnVuYy1uYW1lcyAqL1xuLyogZXNsaW50LWRpc2FibGUgbm8tdW5kZWYgKi9cbmNvbnN0IHNlbmRKU09OcmVzcG9uc2UgPSBmdW5jdGlvbiAocmVzLCBzdGF0dXMsIGNvbnRlbnQpIHtcbiAgcmVzLnN0YXR1cyhzdGF0dXMpO1xuICByZXMuanNvbihjb250ZW50KTtcbn07XG5cbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby11c2VsZXNzLWNvbmNhdFxuZnVuY3Rpb24gdGltZVN0YW1wKCkge1xuICByZXR1cm4gYCR7KG5ldyBEYXRlKCkpLmdldEZ1bGxZZWFyKCl9LSR7KG5ldyBEYXRlKCkpLmdldE1vbnRoKCkgKyAxfS0keyhuZXcgRGF0ZSgpKS5nZXREYXRlKCl9ICAkeyhuZXcgRGF0ZSgpKS5nZXRIb3VycygpfTokeyhuZXcgRGF0ZSgpKS5nZXRNaW51dGVzKCl9OiR7KG5ldyBEYXRlKCkpLmdldFNlY29uZHMoKX1gO1xufVxuXG5jb25zdCBoYXNJZCA9IGZ1bmN0aW9uIChhcnIsIGlkKSB7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgYXJyLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgaWYgKGFycltpXSA9PT0gaWQpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgfVxuICByZXR1cm4gZmFsc2U7XG59O1xuXG5cbm1vZHVsZS5leHBvcnRzLmNyZWF0ZSA9IGZ1bmN0aW9uIChyZXEsIHJlcykge1xuICBpZiAoIXJlcS5ib2R5LmZpcnN0TmFtZSB8fCAhcmVxLmJvZHkubGFzdE5hbWUgfHwgIXJlcS5ib2R5LmVtYWlsIHx8ICFyZXEuYm9keS5hY2NvdW50VHlwZSkge1xuICAgIHNlbmRKU09OcmVzcG9uc2UocmVzLCA0MDAsIHtcbiAgICAgIHN0YXR1czogNDAwLFxuICAgICAgZXJyb3I6ICdGaXJzdCBuYW1lLCBsYXN0IG5hbWUsIGVtYWlsIGFuZCBhY2NvdW50VHlwZSBhcmUgcmVxdWlyZWQsIHBsZWFzZSEnLFxuICAgIH0pO1xuICB9IGVsc2Uge1xuICAgIGlmICghVXNlcnNbcmVxLmJvZHkuZW1haWxdKSB7XG4gICAgICBzZW5kSlNPTnJlc3BvbnNlKHJlcywgNDA0LCB7XG4gICAgICAgIHN0YXR1czogNDA0LFxuICAgICAgICBlcnJvcjogJ1lvdSBoYXZlIG5vdCBzaWduZWQgdXAuIFNpZ24gdXAgZmlyc3QgdG8gY3JlYXRlIGFuIGFjY291bnQhJyxcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGNvbnN0IGFjY291bnQgPSB7fTtcblxuICAgIGFjY291bnQuYWNjb3VudE51bWJlciA9IG5leHRBY2NvdW50O1xuICAgIG5leHRBY2NvdW50ICs9IDE7XG4gICAgYWNjb3VudC5maXJzdE5hbWUgPSByZXEuYm9keS5maXJzdE5hbWU7XG4gICAgYWNjb3VudC5sYXN0TmFtZSA9IHJlcS5ib2R5Lmxhc3ROYW1lO1xuICAgIGFjY291bnQuZW1haWwgPSByZXEuYm9keS5lbWFpbDtcbiAgICBhY2NvdW50LnR5cGUgPSByZXEuYm9keS5hY2NvdW50VHlwZTtcbiAgICBhY2NvdW50Lm9wZW5pbmdCYWxhbmNlID0gMC4wMDtcbiAgICBhY2NvdW50LmNyZWF0ZWRPbiA9IHRpbWVTdGFtcCgpO1xuICAgIGFjY291bnQub3duZXIgPSBVc2Vyc1tyZXEuYm9keS5lbWFpbF0uaWQ7XG4gICAgYWNjb3VudC5zdGF0dXMgPSAnYWN0aXZlJztcbiAgICBhY2NvdW50LmJhbGFuY2UgPSAwLjAwO1xuICAgIGFjY291bnQuaWQgPSBPYmplY3Qua2V5cyhBY2NvdW50cykubGVuZ3RoO1xuXG5cbiAgICBBY2NvdW50c1thY2NvdW50LmFjY291bnROdW1iZXJdID0gYWNjb3VudDtcblxuXG4gICAgc2VuZEpTT05yZXNwb25zZShyZXMsIDIwMSwgeyBzdGF0dXM6IDIwMSwgZGF0YTogYWNjb3VudCB9KTtcbiAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMuYWN0aXZhdGVfZGVhY3RpdmF0ZSA9IGZ1bmN0aW9uIChyZXEsIHJlcykge1xuICBpZiAoIXJlcS5wYXJhbXMuYWNjb3VudE51bWJlcikge1xuICAgIHNlbmRKU09OcmVzcG9uc2UocmVzLCA0MDAsIHtcbiAgICAgIHN0YXR1czogNDAwLFxuICAgICAgZXJyb3I6ICdZb3UgaGF2ZSBub3Qgc3BlY2lmaWVkIHRoZSBhY2NvdW50IG51bWJlciBpbiB0aGUgcGFyYW1zIScsXG4gICAgfSk7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgaWYgKCFyZXEuYm9keS5lbWFpbCkge1xuICAgIHNlbmRKU09OcmVzcG9uc2UocmVzLCA0MDAsIHtcbiAgICAgIHN0YXR1czogNDAwLFxuICAgICAgZXJyb3I6ICdFbnRlciB5b3VyIGVtYWlsIScsXG4gICAgfSk7XG4gICAgcmV0dXJuO1xuICB9XG5cblxuICBpZiAoIUFjY291bnRzW3JlcS5wYXJhbXMuYWNjb3VudE51bWJlcl0pIHtcbiAgICBzZW5kSlNPTnJlc3BvbnNlKHJlcywgNDA0LCB7XG4gICAgICBzdGF0dXM6IDQwNCxcbiAgICAgIGVycm9yOiBcIkFjY291bnQgbnVtYmVyIGRvZXNuJ3QgZXhpc3QgaW4gdGhlIGZpcnN0IHBsYWNlIG9yIGl0IHdhcyBkZWxldGVkIVwiLFxuICAgIH0pO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmICghVXNlcnNbcmVxLmJvZHkuZW1haWxdKSB7XG4gICAgc2VuZEpTT05yZXNwb25zZShyZXMsIDQwNCwge1xuICAgICAgc3RhdHVzOiA0MDQsXG4gICAgICBlcnJvcjogJ1lvdSBoYXZlIG5vdCBzaWduZWQgdXAhJyxcbiAgICB9KTtcbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAoIShoYXNJZChzdGFmZklkcywgcGFyc2VJbnQoVXNlcnNbcmVxLmJvZHkuZW1haWxdLmlkLCAxMCkpXG4gICAgICB8fCBoYXNJZChhZG1pbklkcywgcGFyc2VJbnQoVXNlcnNbcmVxLmJvZHkuZW1haWxdLmlkLCAxMCkpKSkge1xuICAgIHNlbmRKU09OcmVzcG9uc2UocmVzLCA0MDQsIHtcbiAgICAgIHN0YXR1czogNDA0LFxuICAgICAgZXJyb3I6ICdSZWdpc3RlciBhcyBTdGFmZiBvciBBZG1pbiBmaXJzdCwgdXNpbmcgeW91ciBwcml2YXRlbHkgYXNzaWduZWQgSWQhJyxcbiAgICB9KTtcbiAgICByZXR1cm47XG4gIH1cblxuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW51c2VkLWV4cHJlc3Npb25zXG4gIEFjY291bnRzW3JlcS5wYXJhbXMuYWNjb3VudE51bWJlcl0uc3RhdHVzID09PSAnZG9ybWFudCdcbiAgICA/IEFjY291bnRzW3JlcS5wYXJhbXMuYWNjb3VudE51bWJlcl0uc3RhdHVzID0gJ2FjdGl2ZSdcbiAgICA6IEFjY291bnRzW3JlcS5wYXJhbXMuYWNjb3VudE51bWJlcl0uc3RhdHVzID0gJ2Rvcm1hbnQnO1xuICBjb25zdCBhY2NvdW50ID0gQWNjb3VudHNbcmVxLnBhcmFtcy5hY2NvdW50TnVtYmVyXTtcblxuXG4gIHNlbmRKU09OcmVzcG9uc2UocmVzLCAyMDEsIHsgc3RhdHVzOiAyMDEsIGRhdGE6IGFjY291bnQgfSk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cy5kZWxldGUgPSBmdW5jdGlvbiAocmVxLCByZXMpIHtcbiAgaWYgKCFyZXEucGFyYW1zLmFjY291bnROdW1iZXIpIHtcbiAgICBzZW5kSlNPTnJlc3BvbnNlKHJlcywgNDAwLCB7XG4gICAgICBzdGF0dXM6IDQwMCxcbiAgICAgIGVycm9yOiAnWW91IGhhdmUgbm90IHNwZWNpZmllZCB0aGUgYWNjb3VudCBudW1iZXIgaW4gdGhlIHBhcmFtcyEnLFxuICAgIH0pO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmICghcmVxLmJvZHkuZW1haWwpIHtcbiAgICBzZW5kSlNPTnJlc3BvbnNlKHJlcywgNDAwLCB7XG4gICAgICBzdGF0dXM6IDQwMCxcbiAgICAgIGVycm9yOiAnRW50ZXIgeW91ciBlbWFpbCEnLFxuICAgIH0pO1xuICB9IGVsc2Uge1xuICAgIGlmICghQWNjb3VudHNbcmVxLnBhcmFtcy5hY2NvdW50TnVtYmVyXSkge1xuICAgICAgc2VuZEpTT05yZXNwb25zZShyZXMsIDQwNCwge1xuICAgICAgICBzdGF0dXM6IDQwNCxcbiAgICAgICAgZXJyb3I6IFwiQWNjb3VudCBudW1iZXIgZG9lc24ndCBleGlzdCBpbiB0aGUgZmlyc3QgcGxhY2Ugb3IgaXQgd2FzIGRlbGV0ZWQhXCIsXG4gICAgICB9KTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCByZWdVc2VyRW1haWwgPSBVc2Vyc1tyZXEuYm9keS5lbWFpbF07XG5cbiAgICBpZiAoIXJlZ1VzZXJFbWFpbCkge1xuICAgICAgc2VuZEpTT05yZXNwb25zZShyZXMsIDQwNCwge1xuICAgICAgICBzdGF0dXM6IDQwNCxcbiAgICAgICAgZXJyb3I6ICdZb3UgaGF2ZSBub3Qgc2lnbmVkIHVwIHRvIHBlcmZvcm0gdGhpcyBhY3Rpb24hJyxcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmICghKGhhc0lkKHN0YWZmSWRzLCBwYXJzZUludChyZWdVc2VyRW1haWwuaWQsIDEwKSlcbiAgICAgICAgfHwgaGFzSWQoYWRtaW5JZHMsIHBhcnNlSW50KHJlZ1VzZXJFbWFpbC5pZCwgMTApKSkpIHtcbiAgICAgIHNlbmRKU09OcmVzcG9uc2UocmVzLCA0MDQsIHtcbiAgICAgICAgc3RhdHVzOiA0MDQsXG4gICAgICAgIGVycm9yOiAnUmVnaXN0ZXIgYXMgU3RhZmYgb3IgQWRtaW4gZmlyc3QsIHVzaW5nIHlvdXIgcHJpdmF0ZWx5IGFzc2lnbmVkIElkIScsXG4gICAgICB9KTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBkZWxldGUgQWNjb3VudHNbcmVxLnBhcmFtcy5hY2NvdW50TnVtYmVyXTtcbiAgICBzZW5kSlNPTnJlc3BvbnNlKHJlcywgMjAwLCB7IHN0YXR1czogMjA0LCBtZXNzYWdlOiAnQWNjb3VudCBkZWxldGVkIHN1Y2Nlc3NmdWxseSEnIH0pO1xuICB9XG59O1xuIl19