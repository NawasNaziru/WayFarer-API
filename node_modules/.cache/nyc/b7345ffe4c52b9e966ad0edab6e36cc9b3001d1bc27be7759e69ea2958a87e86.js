'use strict';/* eslint-disable func-names */ /* eslint-disable no-undef */var cov_2qn8m28rek=function(){var path="C:\\Users\\owner\\Banka\\app_api\\controllers\\accounts.js";var hash="118b94987766dea1da23a00d6719d7233335c82e";var Function=function(){}.constructor;var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\owner\\Banka\\app_api\\controllers\\accounts.js",statementMap:{"0":{start:{line:5,column:25},end:{line:8,column:1}},"1":{start:{line:6,column:2},end:{line:6,column:21}},"2":{start:{line:7,column:2},end:{line:7,column:20}},"3":{start:{line:12,column:2},end:{line:12,column:172}},"4":{start:{line:15,column:14},end:{line:22,column:1}},"5":{start:{line:16,column:2},end:{line:20,column:3}},"6":{start:{line:16,column:15},end:{line:16,column:16}},"7":{start:{line:17,column:4},end:{line:19,column:5}},"8":{start:{line:18,column:6},end:{line:18,column:18}},"9":{start:{line:21,column:2},end:{line:21,column:15}},"10":{start:{line:24,column:0},end:{line:57,column:2}},"11":{start:{line:25,column:2},end:{line:56,column:3}},"12":{start:{line:26,column:4},end:{line:29,column:7}},"13":{start:{line:31,column:4},end:{line:36,column:5}},"14":{start:{line:32,column:6},end:{line:35,column:9}},"15":{start:{line:38,column:20},end:{line:38,column:22}},"16":{start:{line:40,column:4},end:{line:40,column:40}},"17":{start:{line:41,column:4},end:{line:41,column:21}},"18":{start:{line:42,column:4},end:{line:42,column:43}},"19":{start:{line:43,column:4},end:{line:43,column:41}},"20":{start:{line:44,column:4},end:{line:44,column:35}},"21":{start:{line:45,column:4},end:{line:45,column:40}},"22":{start:{line:46,column:4},end:{line:46,column:34}},"23":{start:{line:47,column:4},end:{line:47,column:36}},"24":{start:{line:48,column:4},end:{line:48,column:45}},"25":{start:{line:49,column:4},end:{line:49,column:30}},"26":{start:{line:50,column:4},end:{line:50,column:27}},"27":{start:{line:51,column:4},end:{line:51,column:46}},"28":{start:{line:53,column:4},end:{line:53,column:46}},"29":{start:{line:55,column:4},end:{line:55,column:63}},"30":{start:{line:59,column:0},end:{line:105,column:2}},"31":{start:{line:60,column:2},end:{line:66,column:3}},"32":{start:{line:61,column:4},end:{line:64,column:7}},"33":{start:{line:65,column:4},end:{line:65,column:11}},"34":{start:{line:68,column:2},end:{line:74,column:3}},"35":{start:{line:69,column:4},end:{line:72,column:7}},"36":{start:{line:73,column:4},end:{line:73,column:11}},"37":{start:{line:76,column:2},end:{line:82,column:3}},"38":{start:{line:77,column:4},end:{line:80,column:7}},"39":{start:{line:81,column:4},end:{line:81,column:11}},"40":{start:{line:84,column:2},end:{line:90,column:3}},"41":{start:{line:85,column:4},end:{line:88,column:7}},"42":{start:{line:89,column:4},end:{line:89,column:11}},"43":{start:{line:92,column:2},end:{line:98,column:3}},"44":{start:{line:93,column:4},end:{line:96,column:7}},"45":{start:{line:97,column:4},end:{line:97,column:11}},"46":{start:{line:101,column:2},end:{line:101,column:169}},"47":{start:{line:102,column:18},end:{line:102,column:52}},"48":{start:{line:104,column:2},end:{line:104,column:61}},"49":{start:{line:107,column:0},end:{line:151,column:2}},"50":{start:{line:108,column:2},end:{line:114,column:3}},"51":{start:{line:109,column:4},end:{line:112,column:7}},"52":{start:{line:113,column:4},end:{line:113,column:11}},"53":{start:{line:116,column:2},end:{line:150,column:3}},"54":{start:{line:117,column:4},end:{line:120,column:7}},"55":{start:{line:122,column:4},end:{line:128,column:5}},"56":{start:{line:123,column:6},end:{line:126,column:9}},"57":{start:{line:127,column:6},end:{line:127,column:13}},"58":{start:{line:130,column:25},end:{line:130,column:46}},"59":{start:{line:132,column:4},end:{line:138,column:5}},"60":{start:{line:133,column:6},end:{line:136,column:9}},"61":{start:{line:137,column:6},end:{line:137,column:13}},"62":{start:{line:140,column:4},end:{line:146,column:5}},"63":{start:{line:141,column:6},end:{line:144,column:9}},"64":{start:{line:145,column:6},end:{line:145,column:13}},"65":{start:{line:148,column:4},end:{line:148,column:46}},"66":{start:{line:149,column:4},end:{line:149,column:90}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:5,column:25},end:{line:5,column:26}},loc:{start:{line:5,column:57},end:{line:8,column:1}},line:5},"1":{name:"timeStamp",decl:{start:{line:11,column:9},end:{line:11,column:18}},loc:{start:{line:11,column:21},end:{line:13,column:1}},line:11},"2":{name:"(anonymous_2)",decl:{start:{line:15,column:14},end:{line:15,column:15}},loc:{start:{line:15,column:33},end:{line:22,column:1}},line:15},"3":{name:"(anonymous_3)",decl:{start:{line:24,column:24},end:{line:24,column:25}},loc:{start:{line:24,column:44},end:{line:57,column:1}},line:24},"4":{name:"(anonymous_4)",decl:{start:{line:59,column:37},end:{line:59,column:38}},loc:{start:{line:59,column:57},end:{line:105,column:1}},line:59},"5":{name:"(anonymous_5)",decl:{start:{line:107,column:24},end:{line:107,column:25}},loc:{start:{line:107,column:44},end:{line:151,column:1}},line:107}},branchMap:{"0":{loc:{start:{line:17,column:4},end:{line:19,column:5}},type:"if",locations:[{start:{line:17,column:4},end:{line:19,column:5}},{start:{line:17,column:4},end:{line:19,column:5}}],line:17},"1":{loc:{start:{line:25,column:2},end:{line:56,column:3}},type:"if",locations:[{start:{line:25,column:2},end:{line:56,column:3}},{start:{line:25,column:2},end:{line:56,column:3}}],line:25},"2":{loc:{start:{line:25,column:6},end:{line:25,column:91}},type:"binary-expr",locations:[{start:{line:25,column:6},end:{line:25,column:25}},{start:{line:25,column:29},end:{line:25,column:47}},{start:{line:25,column:51},end:{line:25,column:66}},{start:{line:25,column:70},end:{line:25,column:91}}],line:25},"3":{loc:{start:{line:31,column:4},end:{line:36,column:5}},type:"if",locations:[{start:{line:31,column:4},end:{line:36,column:5}},{start:{line:31,column:4},end:{line:36,column:5}}],line:31},"4":{loc:{start:{line:60,column:2},end:{line:66,column:3}},type:"if",locations:[{start:{line:60,column:2},end:{line:66,column:3}},{start:{line:60,column:2},end:{line:66,column:3}}],line:60},"5":{loc:{start:{line:68,column:2},end:{line:74,column:3}},type:"if",locations:[{start:{line:68,column:2},end:{line:74,column:3}},{start:{line:68,column:2},end:{line:74,column:3}}],line:68},"6":{loc:{start:{line:76,column:2},end:{line:82,column:3}},type:"if",locations:[{start:{line:76,column:2},end:{line:82,column:3}},{start:{line:76,column:2},end:{line:82,column:3}}],line:76},"7":{loc:{start:{line:84,column:2},end:{line:90,column:3}},type:"if",locations:[{start:{line:84,column:2},end:{line:90,column:3}},{start:{line:84,column:2},end:{line:90,column:3}}],line:84},"8":{loc:{start:{line:92,column:2},end:{line:98,column:3}},type:"if",locations:[{start:{line:92,column:2},end:{line:98,column:3}},{start:{line:92,column:2},end:{line:98,column:3}}],line:92},"9":{loc:{start:{line:92,column:8},end:{line:92,column:122}},type:"binary-expr",locations:[{start:{line:92,column:8},end:{line:92,column:63}},{start:{line:92,column:67},end:{line:92,column:122}}],line:92},"10":{loc:{start:{line:101,column:2},end:{line:101,column:168}},type:"cond-expr",locations:[{start:{line:101,column:60},end:{line:101,column:112}},{start:{line:101,column:115},end:{line:101,column:168}}],line:101},"11":{loc:{start:{line:108,column:2},end:{line:114,column:3}},type:"if",locations:[{start:{line:108,column:2},end:{line:114,column:3}},{start:{line:108,column:2},end:{line:114,column:3}}],line:108},"12":{loc:{start:{line:116,column:2},end:{line:150,column:3}},type:"if",locations:[{start:{line:116,column:2},end:{line:150,column:3}},{start:{line:116,column:2},end:{line:150,column:3}}],line:116},"13":{loc:{start:{line:122,column:4},end:{line:128,column:5}},type:"if",locations:[{start:{line:122,column:4},end:{line:128,column:5}},{start:{line:122,column:4},end:{line:128,column:5}}],line:122},"14":{loc:{start:{line:132,column:4},end:{line:138,column:5}},type:"if",locations:[{start:{line:132,column:4},end:{line:138,column:5}},{start:{line:132,column:4},end:{line:138,column:5}}],line:132},"15":{loc:{start:{line:140,column:4},end:{line:146,column:5}},type:"if",locations:[{start:{line:140,column:4},end:{line:146,column:5}},{start:{line:140,column:4},end:{line:146,column:5}}],line:140},"16":{loc:{start:{line:140,column:10},end:{line:140,column:106}},type:"binary-expr",locations:[{start:{line:140,column:10},end:{line:140,column:56}},{start:{line:140,column:60},end:{line:140,column:106}}],line:140}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0},b:{"0":[0,0],"1":[0,0],"2":[0,0,0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0]},_coverageSchema:"43e27e138ebf9cfc5966b082cf9a028302ed4184"};var coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();cov_2qn8m28rek.s[0]++;const sendJSONresponse=function(res,status,content){cov_2qn8m28rek.f[0]++;cov_2qn8m28rek.s[1]++;res.status(status);cov_2qn8m28rek.s[2]++;res.json(content);};// eslint-disable-next-line no-useless-concat
function timeStamp(){cov_2qn8m28rek.f[1]++;cov_2qn8m28rek.s[3]++;return`${new Date().getFullYear()}-${new Date().getMonth()+1}-${new Date().getDate()}  ${new Date().getHours()}:${new Date().getMinutes()}:${new Date().getSeconds()}`;}cov_2qn8m28rek.s[4]++;const hasId=function(arr,id){cov_2qn8m28rek.f[2]++;cov_2qn8m28rek.s[5]++;for(let i=(cov_2qn8m28rek.s[6]++,0);i<arr.length;i+=1){cov_2qn8m28rek.s[7]++;if(arr[i]===id){cov_2qn8m28rek.b[0][0]++;cov_2qn8m28rek.s[8]++;return true;}else{cov_2qn8m28rek.b[0][1]++;}}cov_2qn8m28rek.s[9]++;return false;};cov_2qn8m28rek.s[10]++;module.exports.create=function(req,res){cov_2qn8m28rek.f[3]++;cov_2qn8m28rek.s[11]++;if((cov_2qn8m28rek.b[2][0]++,!req.body.firstName)||(cov_2qn8m28rek.b[2][1]++,!req.body.lastName)||(cov_2qn8m28rek.b[2][2]++,!req.body.email)||(cov_2qn8m28rek.b[2][3]++,!req.body.accountType)){cov_2qn8m28rek.b[1][0]++;cov_2qn8m28rek.s[12]++;sendJSONresponse(res,400,{status:400,error:'First name, last name, email and accountType are required, please!'});}else{cov_2qn8m28rek.b[1][1]++;cov_2qn8m28rek.s[13]++;if(!Users[req.body.email]){cov_2qn8m28rek.b[3][0]++;cov_2qn8m28rek.s[14]++;sendJSONresponse(res,404,{status:404,error:'You have not signed up. Sign up first to create an account!'});}else{cov_2qn8m28rek.b[3][1]++;}const account=(cov_2qn8m28rek.s[15]++,{});cov_2qn8m28rek.s[16]++;account.accountNumber=nextAccount;cov_2qn8m28rek.s[17]++;nextAccount+=1;cov_2qn8m28rek.s[18]++;account.firstName=req.body.firstName;cov_2qn8m28rek.s[19]++;account.lastName=req.body.lastName;cov_2qn8m28rek.s[20]++;account.email=req.body.email;cov_2qn8m28rek.s[21]++;account.type=req.body.accountType;cov_2qn8m28rek.s[22]++;account.openingBalance=0.00;cov_2qn8m28rek.s[23]++;account.createdOn=timeStamp();cov_2qn8m28rek.s[24]++;account.owner=Users[req.body.email].id;cov_2qn8m28rek.s[25]++;account.status='active';cov_2qn8m28rek.s[26]++;account.balance=0.00;cov_2qn8m28rek.s[27]++;account.id=Object.keys(Accounts).length;cov_2qn8m28rek.s[28]++;Accounts[account.accountNumber]=account;cov_2qn8m28rek.s[29]++;sendJSONresponse(res,201,{status:201,data:account});}};cov_2qn8m28rek.s[30]++;module.exports.activate_deactivate=function(req,res){cov_2qn8m28rek.f[4]++;cov_2qn8m28rek.s[31]++;if(!req.params.accountNumber){cov_2qn8m28rek.b[4][0]++;cov_2qn8m28rek.s[32]++;sendJSONresponse(res,400,{status:400,error:'You have not specified the account number in the params!'});cov_2qn8m28rek.s[33]++;return;}else{cov_2qn8m28rek.b[4][1]++;}cov_2qn8m28rek.s[34]++;if(!req.body.email){cov_2qn8m28rek.b[5][0]++;cov_2qn8m28rek.s[35]++;sendJSONresponse(res,400,{status:400,error:'Enter your email!'});cov_2qn8m28rek.s[36]++;return;}else{cov_2qn8m28rek.b[5][1]++;}cov_2qn8m28rek.s[37]++;if(!Accounts[req.params.accountNumber]){cov_2qn8m28rek.b[6][0]++;cov_2qn8m28rek.s[38]++;sendJSONresponse(res,404,{status:404,error:"Account number doesn't exist in the first place or it was deleted!"});cov_2qn8m28rek.s[39]++;return;}else{cov_2qn8m28rek.b[6][1]++;}cov_2qn8m28rek.s[40]++;if(!Users[req.body.email]){cov_2qn8m28rek.b[7][0]++;cov_2qn8m28rek.s[41]++;sendJSONresponse(res,404,{status:404,error:'You have not signed up!'});cov_2qn8m28rek.s[42]++;return;}else{cov_2qn8m28rek.b[7][1]++;}cov_2qn8m28rek.s[43]++;if(!((cov_2qn8m28rek.b[9][0]++,hasId(staffIds,parseInt(Users[req.body.email].id,10)))||(cov_2qn8m28rek.b[9][1]++,hasId(adminIds,parseInt(Users[req.body.email].id,10))))){cov_2qn8m28rek.b[8][0]++;cov_2qn8m28rek.s[44]++;sendJSONresponse(res,404,{status:404,error:'Register as Staff or Admin first, using your privately assigned Id!'});cov_2qn8m28rek.s[45]++;return;}else{cov_2qn8m28rek.b[8][1]++;}// eslint-disable-next-line no-unused-expressions
cov_2qn8m28rek.s[46]++;Accounts[req.params.accountNumber].status==='dormant'?(cov_2qn8m28rek.b[10][0]++,Accounts[req.params.accountNumber].status='active'):(cov_2qn8m28rek.b[10][1]++,Accounts[req.params.accountNumber].status='dormant');const account=(cov_2qn8m28rek.s[47]++,Accounts[req.params.accountNumber]);cov_2qn8m28rek.s[48]++;sendJSONresponse(res,201,{status:201,data:account});};cov_2qn8m28rek.s[49]++;module.exports.delete=function(req,res){cov_2qn8m28rek.f[5]++;cov_2qn8m28rek.s[50]++;if(!req.params.accountNumber){cov_2qn8m28rek.b[11][0]++;cov_2qn8m28rek.s[51]++;sendJSONresponse(res,400,{status:400,error:'You have not specified the account number in the params!'});cov_2qn8m28rek.s[52]++;return;}else{cov_2qn8m28rek.b[11][1]++;}cov_2qn8m28rek.s[53]++;if(!req.body.email){cov_2qn8m28rek.b[12][0]++;cov_2qn8m28rek.s[54]++;sendJSONresponse(res,400,{status:400,error:'Enter your email!'});}else{cov_2qn8m28rek.b[12][1]++;cov_2qn8m28rek.s[55]++;if(!Accounts[req.params.accountNumber]){cov_2qn8m28rek.b[13][0]++;cov_2qn8m28rek.s[56]++;sendJSONresponse(res,404,{status:404,error:"Account number doesn't exist in the first place or it was deleted!"});cov_2qn8m28rek.s[57]++;return;}else{cov_2qn8m28rek.b[13][1]++;}const regUserEmail=(cov_2qn8m28rek.s[58]++,Users[req.body.email]);cov_2qn8m28rek.s[59]++;if(!regUserEmail){cov_2qn8m28rek.b[14][0]++;cov_2qn8m28rek.s[60]++;sendJSONresponse(res,404,{status:404,error:'You have not signed up to perform this action!'});cov_2qn8m28rek.s[61]++;return;}else{cov_2qn8m28rek.b[14][1]++;}cov_2qn8m28rek.s[62]++;if(!((cov_2qn8m28rek.b[16][0]++,hasId(staffIds,parseInt(regUserEmail.id,10)))||(cov_2qn8m28rek.b[16][1]++,hasId(adminIds,parseInt(regUserEmail.id,10))))){cov_2qn8m28rek.b[15][0]++;cov_2qn8m28rek.s[63]++;sendJSONresponse(res,404,{status:404,error:'Register as Staff or Admin first, using your privately assigned Id!'});cov_2qn8m28rek.s[64]++;return;}else{cov_2qn8m28rek.b[15][1]++;}cov_2qn8m28rek.s[65]++;delete Accounts[req.params.accountNumber];cov_2qn8m28rek.s[66]++;sendJSONresponse(res,200,{status:204,message:'Account deleted successfully!'});}};//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFjY291bnRzLmpzIl0sIm5hbWVzIjpbInNlbmRKU09OcmVzcG9uc2UiLCJyZXMiLCJzdGF0dXMiLCJjb250ZW50IiwianNvbiIsInRpbWVTdGFtcCIsIkRhdGUiLCJnZXRGdWxsWWVhciIsImdldE1vbnRoIiwiZ2V0RGF0ZSIsImdldEhvdXJzIiwiZ2V0TWludXRlcyIsImdldFNlY29uZHMiLCJoYXNJZCIsImFyciIsImlkIiwiaSIsImxlbmd0aCIsIm1vZHVsZSIsImV4cG9ydHMiLCJjcmVhdGUiLCJyZXEiLCJib2R5IiwiZmlyc3ROYW1lIiwibGFzdE5hbWUiLCJlbWFpbCIsImFjY291bnRUeXBlIiwiZXJyb3IiLCJVc2VycyIsImFjY291bnQiLCJhY2NvdW50TnVtYmVyIiwibmV4dEFjY291bnQiLCJ0eXBlIiwib3BlbmluZ0JhbGFuY2UiLCJjcmVhdGVkT24iLCJvd25lciIsImJhbGFuY2UiLCJPYmplY3QiLCJrZXlzIiwiQWNjb3VudHMiLCJkYXRhIiwiYWN0aXZhdGVfZGVhY3RpdmF0ZSIsInBhcmFtcyIsInN0YWZmSWRzIiwicGFyc2VJbnQiLCJhZG1pbklkcyIsImRlbGV0ZSIsInJlZ1VzZXJFbWFpbCIsIm1lc3NhZ2UiXSwibWFwcGluZ3MiOiI7O0FBQUE7QUFDQTtBQUNBLE1BQU1BLG1CQUFtQixVQUFVQyxHQUFWLEVBQWVDLE1BQWYsRUFBdUJDLE9BQXZCLEVBQWdDO0FBQ3ZERixNQUFJQyxNQUFKLENBQVdBLE1BQVg7QUFDQUQsTUFBSUcsSUFBSixDQUFTRCxPQUFUO0FBQ0QsQ0FIRDs7QUFLQTtBQUNBLFNBQVNFLFNBQVQsR0FBcUI7QUFDbkIsU0FBUSxHQUFHLElBQUlDLElBQUosRUFBRCxDQUFhQyxXQUFiLEVBQTJCLElBQUksSUFBSUQsSUFBSixFQUFELENBQWFFLFFBQWIsS0FBMEIsQ0FBRSxJQUFJLElBQUlGLElBQUosRUFBRCxDQUFhRyxPQUFiLEVBQXVCLEtBQUssSUFBSUgsSUFBSixFQUFELENBQWFJLFFBQWIsRUFBd0IsSUFB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QUFJQTtBQUNEOztBQUVELFdBQU9ZLFNBQVNsQixJQUFJcUIsTUFBSixDQUFXWixhQUFwQixDQUFQO0FBQ0E5QixxQkFBaUJDLEdBQWpCLEVBQXNCLEdBQXRCLEVBQTJCLEVBQUVDLFFBQVEsR0FBVixFQUFlOEMsU0FBUywrQkFBeEIsRUFBM0I7QUFDRDtBQUNGLENBN0NEIiwiZmlsZSI6ImFjY291bnRzLmpzIiwic291cmNlUm9vdCI6IkM6L1VzZXJzL293bmVyL0JhbmthL2FwcF9hcGkvY29udHJvbGxlcnMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiBlc2xpbnQtZGlzYWJsZSBmdW5jLW5hbWVzICovXG4vKiBlc2xpbnQtZGlzYWJsZSBuby11bmRlZiAqL1xuY29uc3Qgc2VuZEpTT05yZXNwb25zZSA9IGZ1bmN0aW9uIChyZXMsIHN0YXR1cywgY29udGVudCkge1xuICByZXMuc3RhdHVzKHN0YXR1cyk7XG4gIHJlcy5qc29uKGNvbnRlbnQpO1xufTtcblxuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXVzZWxlc3MtY29uY2F0XG5mdW5jdGlvbiB0aW1lU3RhbXAoKSB7XG4gIHJldHVybiBgJHsobmV3IERhdGUoKSkuZ2V0RnVsbFllYXIoKX0tJHsobmV3IERhdGUoKSkuZ2V0TW9udGgoKSArIDF9LSR7KG5ldyBEYXRlKCkpLmdldERhdGUoKX0gICR7KG5ldyBEYXRlKCkpLmdldEhvdXJzKCl9OiR7KG5ldyBEYXRlKCkpLmdldE1pbnV0ZXMoKX06JHsobmV3IERhdGUoKSkuZ2V0U2Vjb25kcygpfWA7XG59XG5cbmNvbnN0IGhhc0lkID0gZnVuY3Rpb24gKGFyciwgaWQpIHtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBhcnIubGVuZ3RoOyBpICs9IDEpIHtcbiAgICBpZiAoYXJyW2ldID09PSBpZCkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICB9XG4gIHJldHVybiBmYWxzZTtcbn07XG5cblxubW9kdWxlLmV4cG9ydHMuY3JlYXRlID0gZnVuY3Rpb24gKHJlcSwgcmVzKSB7XG4gIGlmICghcmVxLmJvZHkuZmlyc3ROYW1lIHx8ICFyZXEuYm9keS5sYXN0TmFtZSB8fCAhcmVxLmJvZHkuZW1haWwgfHwgIXJlcS5ib2R5LmFjY291bnRUeXBlKSB7XG4gICAgc2VuZEpTT05yZXNwb25zZShyZXMsIDQwMCwge1xuICAgICAgc3RhdHVzOiA0MDAsXG4gICAgICBlcnJvcjogJ0ZpcnN0IG5hbWUsIGxhc3QgbmFtZSwgZW1haWwgYW5kIGFjY291bnRUeXBlIGFyZSByZXF1aXJlZCwgcGxlYXNlIScsXG4gICAgfSk7XG4gIH0gZWxzZSB7XG4gICAgaWYgKCFVc2Vyc1tyZXEuYm9keS5lbWFpbF0pIHtcbiAgICAgIHNlbmRKU09OcmVzcG9uc2UocmVzLCA0MDQsIHtcbiAgICAgICAgc3RhdHVzOiA0MDQsXG4gICAgICAgIGVycm9yOiAnWW91IGhhdmUgbm90IHNpZ25lZCB1cC4gU2lnbiB1cCBmaXJzdCB0byBjcmVhdGUgYW4gYWNjb3VudCEnLFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgY29uc3QgYWNjb3VudCA9IHt9O1xuXG4gICAgYWNjb3VudC5hY2NvdW50TnVtYmVyID0gbmV4dEFjY291bnQ7XG4gICAgbmV4dEFjY291bnQgKz0gMTtcbiAgICBhY2NvdW50LmZpcnN0TmFtZSA9IHJlcS5ib2R5LmZpcnN0TmFtZTtcbiAgICBhY2NvdW50Lmxhc3ROYW1lID0gcmVxLmJvZHkubGFzdE5hbWU7XG4gICAgYWNjb3VudC5lbWFpbCA9IHJlcS5ib2R5LmVtYWlsO1xuICAgIGFjY291bnQudHlwZSA9IHJlcS5ib2R5LmFjY291bnRUeXBlO1xuICAgIGFjY291bnQub3BlbmluZ0JhbGFuY2UgPSAwLjAwO1xuICAgIGFjY291bnQuY3JlYXRlZE9uID0gdGltZVN0YW1wKCk7XG4gICAgYWNjb3VudC5vd25lciA9IFVzZXJzW3JlcS5ib2R5LmVtYWlsXS5pZDtcbiAgICBhY2NvdW50LnN0YXR1cyA9ICdhY3RpdmUnO1xuICAgIGFjY291bnQuYmFsYW5jZSA9IDAuMDA7XG4gICAgYWNjb3VudC5pZCA9IE9iamVjdC5rZXlzKEFjY291bnRzKS5sZW5ndGg7XG5cblxuICAgIEFjY291bnRzW2FjY291bnQuYWNjb3VudE51bWJlcl0gPSBhY2NvdW50O1xuXG5cbiAgICBzZW5kSlNPTnJlc3BvbnNlKHJlcywgMjAxLCB7IHN0YXR1czogMjAxLCBkYXRhOiBhY2NvdW50IH0pO1xuICB9XG59O1xuXG5tb2R1bGUuZXhwb3J0cy5hY3RpdmF0ZV9kZWFjdGl2YXRlID0gZnVuY3Rpb24gKHJlcSwgcmVzKSB7XG4gIGlmICghcmVxLnBhcmFtcy5hY2NvdW50TnVtYmVyKSB7XG4gICAgc2VuZEpTT05yZXNwb25zZShyZXMsIDQwMCwge1xuICAgICAgc3RhdHVzOiA0MDAsXG4gICAgICBlcnJvcjogJ1lvdSBoYXZlIG5vdCBzcGVjaWZpZWQgdGhlIGFjY291bnQgbnVtYmVyIGluIHRoZSBwYXJhbXMhJyxcbiAgICB9KTtcbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAoIXJlcS5ib2R5LmVtYWlsKSB7XG4gICAgc2VuZEpTT05yZXNwb25zZShyZXMsIDQwMCwge1xuICAgICAgc3RhdHVzOiA0MDAsXG4gICAgICBlcnJvcjogJ0VudGVyIHlvdXIgZW1haWwhJyxcbiAgICB9KTtcbiAgICByZXR1cm47XG4gIH1cblxuXG4gIGlmICghQWNjb3VudHNbcmVxLnBhcmFtcy5hY2NvdW50TnVtYmVyXSkge1xuICAgIHNlbmRKU09OcmVzcG9uc2UocmVzLCA0MDQsIHtcbiAgICAgIHN0YXR1czogNDA0LFxuICAgICAgZXJyb3I6IFwiQWNjb3VudCBudW1iZXIgZG9lc24ndCBleGlzdCBpbiB0aGUgZmlyc3QgcGxhY2Ugb3IgaXQgd2FzIGRlbGV0ZWQhXCIsXG4gICAgfSk7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgaWYgKCFVc2Vyc1tyZXEuYm9keS5lbWFpbF0pIHtcbiAgICBzZW5kSlNPTnJlc3BvbnNlKHJlcywgNDA0LCB7XG4gICAgICBzdGF0dXM6IDQwNCxcbiAgICAgIGVycm9yOiAnWW91IGhhdmUgbm90IHNpZ25lZCB1cCEnLFxuICAgIH0pO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmICghKGhhc0lkKHN0YWZmSWRzLCBwYXJzZUludChVc2Vyc1tyZXEuYm9keS5lbWFpbF0uaWQsIDEwKSlcbiAgICAgIHx8IGhhc0lkKGFkbWluSWRzLCBwYXJzZUludChVc2Vyc1tyZXEuYm9keS5lbWFpbF0uaWQsIDEwKSkpKSB7XG4gICAgc2VuZEpTT05yZXNwb25zZShyZXMsIDQwNCwge1xuICAgICAgc3RhdHVzOiA0MDQsXG4gICAgICBlcnJvcjogJ1JlZ2lzdGVyIGFzIFN0YWZmIG9yIEFkbWluIGZpcnN0LCB1c2luZyB5b3VyIHByaXZhdGVseSBhc3NpZ25lZCBJZCEnLFxuICAgIH0pO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby11bnVzZWQtZXhwcmVzc2lvbnNcbiAgQWNjb3VudHNbcmVxLnBhcmFtcy5hY2NvdW50TnVtYmVyXS5zdGF0dXMgPT09ICdkb3JtYW50J1xuICAgID8gQWNjb3VudHNbcmVxLnBhcmFtcy5hY2NvdW50TnVtYmVyXS5zdGF0dXMgPSAnYWN0aXZlJ1xuICAgIDogQWNjb3VudHNbcmVxLnBhcmFtcy5hY2NvdW50TnVtYmVyXS5zdGF0dXMgPSAnZG9ybWFudCc7XG4gIGNvbnN0IGFjY291bnQgPSBBY2NvdW50c1tyZXEucGFyYW1zLmFjY291bnROdW1iZXJdO1xuXG5cbiAgc2VuZEpTT05yZXNwb25zZShyZXMsIDIwMSwgeyBzdGF0dXM6IDIwMSwgZGF0YTogYWNjb3VudCB9KTtcbn07XG5cbm1vZHVsZS5leHBvcnRzLmRlbGV0ZSA9IGZ1bmN0aW9uIChyZXEsIHJlcykge1xuICBpZiAoIXJlcS5wYXJhbXMuYWNjb3VudE51bWJlcikge1xuICAgIHNlbmRKU09OcmVzcG9uc2UocmVzLCA0MDAsIHtcbiAgICAgIHN0YXR1czogNDAwLFxuICAgICAgZXJyb3I6ICdZb3UgaGF2ZSBub3Qgc3BlY2lmaWVkIHRoZSBhY2NvdW50IG51bWJlciBpbiB0aGUgcGFyYW1zIScsXG4gICAgfSk7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgaWYgKCFyZXEuYm9keS5lbWFpbCkge1xuICAgIHNlbmRKU09OcmVzcG9uc2UocmVzLCA0MDAsIHtcbiAgICAgIHN0YXR1czogNDAwLFxuICAgICAgZXJyb3I6ICdFbnRlciB5b3VyIGVtYWlsIScsXG4gICAgfSk7XG4gIH0gZWxzZSB7XG4gICAgaWYgKCFBY2NvdW50c1tyZXEucGFyYW1zLmFjY291bnROdW1iZXJdKSB7XG4gICAgICBzZW5kSlNPTnJlc3BvbnNlKHJlcywgNDA0LCB7XG4gICAgICAgIHN0YXR1czogNDA0LFxuICAgICAgICBlcnJvcjogXCJBY2NvdW50IG51bWJlciBkb2Vzbid0IGV4aXN0IGluIHRoZSBmaXJzdCBwbGFjZSBvciBpdCB3YXMgZGVsZXRlZCFcIixcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IHJlZ1VzZXJFbWFpbCA9IFVzZXJzW3JlcS5ib2R5LmVtYWlsXTtcblxuICAgIGlmICghcmVnVXNlckVtYWlsKSB7XG4gICAgICBzZW5kSlNPTnJlc3BvbnNlKHJlcywgNDA0LCB7XG4gICAgICAgIHN0YXR1czogNDA0LFxuICAgICAgICBlcnJvcjogJ1lvdSBoYXZlIG5vdCBzaWduZWQgdXAgdG8gcGVyZm9ybSB0aGlzIGFjdGlvbiEnLFxuICAgICAgfSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKCEoaGFzSWQoc3RhZmZJZHMsIHBhcnNlSW50KHJlZ1VzZXJFbWFpbC5pZCwgMTApKVxuICAgICAgICB8fCBoYXNJZChhZG1pbklkcywgcGFyc2VJbnQocmVnVXNlckVtYWlsLmlkLCAxMCkpKSkge1xuICAgICAgc2VuZEpTT05yZXNwb25zZShyZXMsIDQwNCwge1xuICAgICAgICBzdGF0dXM6IDQwNCxcbiAgICAgICAgZXJyb3I6ICdSZWdpc3RlciBhcyBTdGFmZiBvciBBZG1pbiBmaXJzdCwgdXNpbmcgeW91ciBwcml2YXRlbHkgYXNzaWduZWQgSWQhJyxcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGRlbGV0ZSBBY2NvdW50c1tyZXEucGFyYW1zLmFjY291bnROdW1iZXJdO1xuICAgIHNlbmRKU09OcmVzcG9uc2UocmVzLCAyMDAsIHsgc3RhdHVzOiAyMDQsIG1lc3NhZ2U6ICdBY2NvdW50IGRlbGV0ZWQgc3VjY2Vzc2Z1bGx5IScgfSk7XG4gIH1cbn07XG4iXX0=